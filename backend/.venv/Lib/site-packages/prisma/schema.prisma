//backend/prisma/generated/schema.prisma
generator client {
  provider = "prisma-client-py"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Supplier {
  id           String    @id @default(cuid())
  url          String?   @unique
  name         String    @default("Unknown Supplier")
  riskScore    String    @default("0")
  summary      String    @default("")
  flags        String[]  @default([])
  analysisData Json?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  chats        ChatLog[]
}

model ChatLog {
  id        String    @id @default(cuid())
  url       String?
  question  String
  answer    String
  sources   String[]
  createdAt DateTime  @default(now())
  supplier  Supplier? @relation(fields: [url], references: [url], onDelete: Cascade, onUpdate: Cascade)

  @@index([url])
}
